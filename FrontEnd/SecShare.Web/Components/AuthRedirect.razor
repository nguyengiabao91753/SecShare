@inject NavigationManager Navigation
@rendermode InteractiveServer
@inject SecShare.Web.Services.IServices.ITokenProvider TokenProvider

@code {
    private bool _initialized = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && !_initialized)
        {
            _initialized = true;

            // Kiểm tra nếu đang ở trang /login thì bỏ qua
            if (Navigation.Uri.Contains("/login") || Navigation.Uri.Contains("/register?"))
            {
                return; // Không redirect nếu đã ở login
            }

            var token = await TokenProvider.GetTokenAsync();

            if (string.IsNullOrEmpty(token))
            {
                Navigation.NavigateTo("/login", forceLoad: true);
            }
        }
    }
}